<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>FMX - src</title><link rel="stylesheet" type="text/css" href="../fmx.css" /></head><body><table border="0" cellpadding="1" width="100%"><tr><td valign="top" rowspan="2" style="padding-bottom: 10px; padding-left: 10px"><img height="90" alt="" src="../logo.png" /></td><td class="title">FMX - Fortran Metrics Analysis Tool</td></tr><tr><td class="title2">
              Version 1.0.0.1</td></tr><tr><td class="ruler" height="3" colspan="2" /></tr></table><table border="0" cellpadding="1" width="95%"><tr><td class="headerItem">Date/time : </td><td class="headerValue">2025-03-09T18:24:38</td><td class="headerItem">Source lines : </td><td class="metricGood">125</td><td class="metricGood">46.64 %</td><td class="headerItem">Minimum complexity : </td><td class="metricGood" title="">1</td></tr><tr><td class="headerItem">Current view : </td><td class="headerValue"><a href="../index.html">Frypto</a>
                 - 
                <a href="index.html">src</a>
                 - m_sha384.f90</td><td class="headerItem">Comment lines : </td><td class="metricGood">82</td><td class="metricGood" title="">30.60 %</td><td class="headerItem">Average complexity : </td><td class="metricGood" title="">2.20</td></tr><tr><td class="headerItem">Type : </td><td class="headerValue">module</td><td class="headerItem">Empty lines : </td><td class="metricGood">61</td><td class="metricGood">22.76 %</td><td class="headerItem">Maximum complexity : </td><td class="metricGood" title="">6</td></tr><tr><td class="headerItem">Name : </td><td class="headerValue">m_sha384</td><td class="headerItem">Total lines : </td><td class="metricGood">268</td><td class="metricGood" /><td class="headerItem" title="&gt; 5 acceptable;  &gt; 10 not-acceptable">Minimum nesting : </td><td class="nestingGood" title="">1</td></tr><tr><td class="headerItem">Methods : </td><td class="headerValue">5</td><td class="headerItem" /><td class="headerValue" /><td class="headerValue" /><td class="headerItem" title="&gt; 5 acceptable;  &gt; 10 not-acceptable">Average nesting : </td><td class="nestingGood" title="">1.40</td></tr><tr><td class="headerItem" /><td class="headerValue" /><td class="headerItem" /><td class="headerValue" /><td class="headerValue" /><td class="headerItem" title="&gt; 5 acceptable;  &gt; 10 not-acceptable">Maximum nesting : </td><td class="nestingGood" title="">2</td></tr><tr><td colspan="8" height="3" class="ruler" /></tr></table><center><table><tr><td class="tableHead" colspan="2">Method</td><td class="tableHead" colspan="4">Statistics</td><td class="tableHead" colspan="1">Complexity</td><td class="tableHead" colspan="1">Nesting</td></tr><tr><td class="tableHead2">Name</td><td class="tableHead2">Type</td><td class="tableHead2">Source</td><td class="tableHead2">Comment</td><td class="tableHead2">Empty</td><td class="tableHead2">Total</td><td class="tableHead2" /><td class="tableHead2" /></tr><tr><td class="methodName"><a href="#code">main</a></td><td class="methodType" /><td class="methodNumber">46
                    (38.98%)
                  </td><td class="methodNumber">47
                    (39.83%)
                  </td><td class="methodNumber">25
                    (21.19%)
                  </td><td class="methodNumber">118</td><td class="methodNumber">0</td><td class="methodNumber">0</td></tr><tr><td class="methodName"><a href="#sha384_default">sha384_default</a></td><td class="methodType">function</td><td class="methodNumber">4
                  (36.36%)
                </td><td class="methodNumber">3
                  (27.27%)
                </td><td class="methodNumber">4
                  (36.36%)
                </td><td class="methodNumber">11</td><td class="metricGood" title="">1</td><td class="nestingGood" title="">1</td></tr><tr><td class="methodName"><a href="#sha384_finalise">sha384_finalise</a></td><td class="methodType">function</td><td class="methodNumber">14
                  (38.89%)
                </td><td class="methodNumber">13
                  (36.11%)
                </td><td class="methodNumber">9
                  (25.00%)
                </td><td class="methodNumber">36</td><td class="metricGood" title="">2</td><td class="nestingGood" title="">2</td></tr><tr><td class="methodName"><a href="#sha384_get_hash_size">sha384_get_hash_size</a></td><td class="methodType">function</td><td class="methodNumber">4
                  (33.33%)
                </td><td class="methodNumber">3
                  (25.00%)
                </td><td class="methodNumber">5
                  (41.67%)
                </td><td class="methodNumber">12</td><td class="metricGood" title="">1</td><td class="nestingGood" title="">1</td></tr><tr><td class="methodName"><a href="#sha384_initialise">sha384_initialise</a></td><td class="methodType">subroutine</td><td class="methodNumber">4
                  (33.33%)
                </td><td class="methodNumber">3
                  (25.00%)
                </td><td class="methodNumber">5
                  (41.67%)
                </td><td class="methodNumber">12</td><td class="metricGood" title="">1</td><td class="nestingGood" title="">1</td></tr><tr><td class="methodName"><a href="#sha384_update">sha384_update</a></td><td class="methodType">subroutine</td><td class="methodNumber">53
                  (67.09%)
                </td><td class="methodNumber">13
                  (16.46%)
                </td><td class="methodNumber">13
                  (16.46%)
                </td><td class="methodNumber">79</td><td class="metricGood" title="">6</td><td class="nestingGood" title="">2</td></tr></table></center><table border="0" cellpadding="1" width="100%"><tr><td class="ruler" height="3" colspan="2" /></tr></table><a name="code" /><center><table border="0" cellpadding="1" width="90%"><tr><td class="tableHead2">L.N.</td><td class="tableHead2">C</td><td class="tableHead2">N</td><td class="tableHead2">Statement</td></tr><tr><td class="codeNumber"><a name="" />1</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">module m_sha384</td></tr><tr><td class="codeNumber"><a name="" />2</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />3</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!------------------------------------------------------------------------------</td></tr><tr><td class="codeNumber"><a name="" />4</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Copyright : 2022, Fran Martinez Fadrique &lt;Fran.Martinez.Fadrique@gmail.com&gt;</td></tr><tr><td class="codeNumber"><a name="" />5</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Project   : Atlantis</td></tr><tr><td class="codeNumber"><a name="" />6</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Author    : Fran Martinez Fadrique</td></tr><tr><td class="codeNumber"><a name="" />7</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Language  : Object Oriented Fortran 2018</td></tr><tr><td class="codeNumber"><a name="" />8</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Reference : FIPS 180-2, Secure Hash Standard</td></tr><tr><td class="codeNumber"><a name="" />9</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf</td></tr><tr><td class="codeNumber"><a name="" />10</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Synopsis  : Cryptographic Secure Hash Algorithm (SHA-512)</td></tr><tr><td class="codeNumber"><a name="" />11</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!</td></tr><tr><td class="codeNumber"><a name="" />12</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! License   : This file is part of Frypto.</td></tr><tr><td class="codeNumber"><a name="" />13</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!</td></tr><tr><td class="codeNumber"><a name="" />14</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             Frypto is free software: you can redistribute it and/or modify</td></tr><tr><td class="codeNumber"><a name="" />15</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             it under the terms of the GNU Lesser General Public License as</td></tr><tr><td class="codeNumber"><a name="" />16</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             published by the Free Software Foundation, either version 3 of</td></tr><tr><td class="codeNumber"><a name="" />17</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             the License, or (at your option) any later version.</td></tr><tr><td class="codeNumber"><a name="" />18</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!</td></tr><tr><td class="codeNumber"><a name="" />19</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             Frypto is distributed in the hope that it will be useful,</td></tr><tr><td class="codeNumber"><a name="" />20</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             but WITHOUT ANY WARRANTY; without even the implied warranty of</td></tr><tr><td class="codeNumber"><a name="" />21</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</td></tr><tr><td class="codeNumber"><a name="" />22</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             See the GNU Lesser General Public License for more details.</td></tr><tr><td class="codeNumber"><a name="" />23</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!</td></tr><tr><td class="codeNumber"><a name="" />24</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             You should have received a copy of the GNU Lesser General Public</td></tr><tr><td class="codeNumber"><a name="" />25</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             License along with Frypto.  </td></tr><tr><td class="codeNumber"><a name="" />26</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!             If not, see &lt;http://www.gnu.org/licenses/&gt;.</td></tr><tr><td class="codeNumber"><a name="" />27</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!------------------------------------------------------------------------------</td></tr><tr><td class="codeNumber"><a name="" />28</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />29</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!- Start of use statements ----------------------------------------------------</td></tr><tr><td class="codeNumber"><a name="" />30</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />31</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  use m_hash64</td></tr><tr><td class="codeNumber"><a name="" />32</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />33</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!- End of use statements ------------------------------------------------------</td></tr><tr><td class="codeNumber"><a name="" />34</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />35</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  implicit none</td></tr><tr><td class="codeNumber"><a name="" />36</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />37</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!- Start of Public/Private declarations ---------------------------------------</td></tr><tr><td class="codeNumber"><a name="" />38</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />39</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  private</td></tr><tr><td class="codeNumber"><a name="" />40</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  public t_sha384</td></tr><tr><td class="codeNumber"><a name="" />41</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  public sha384</td></tr><tr><td class="codeNumber"><a name="" />42</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />43</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!- End of Public/Private declarations -----------------------------------------</td></tr><tr><td class="codeNumber"><a name="" />44</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />45</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!- Start of module variable declarations --------------------------------------</td></tr><tr><td class="codeNumber"><a name="" />46</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />47</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Initial hash value</td></tr><tr><td class="codeNumber"><a name="" />48</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  integer(kind=8), dimension(8), parameter :: H0 = &amp;</td></tr><tr><td class="codeNumber"><a name="" />49</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">   [ int(z'CBBB9D5DC1059ED8',8), int(z'629A292A367CD507',8), int(z'9159015A3070DD17',8), int(z'152FECD8F70E5939',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />50</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'67332667FFC00B31',8), int(z'8EB44A8768581511',8), int(z'DB0C2E0D64F98FA7',8), int(z'47B5481DBEFA4FA4',8) ]</td></tr><tr><td class="codeNumber"><a name="" />51</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />52</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! SHA-384 processing constants</td></tr><tr><td class="codeNumber"><a name="" />53</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  integer(kind=8), parameter, dimension(80) :: K = &amp;</td></tr><tr><td class="codeNumber"><a name="" />54</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">   [ int(z'428A2F98D728AE22',8), int(z'7137449123EF65CD',8), int(z'B5C0FBCFEC4D3B2F',8), int(z'E9B5DBA58189DBBC',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />55</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'3956C25BF348B538',8), int(z'59F111F1B605D019',8), int(z'923F82A4AF194F9B',8), int(z'AB1C5ED5DA6D8118',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />56</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'D807AA98A3030242',8), int(z'12835B0145706FBE',8), int(z'243185BE4EE4B28C',8), int(z'550C7DC3D5FFB4E2',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />57</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'72BE5D74F27B896F',8), int(z'80DEB1FE3B1696B1',8), int(z'9BDC06A725C71235',8), int(z'C19BF174CF692694',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />58</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'E49B69C19EF14AD2',8), int(z'EFBE4786384F25E3',8), int(z'0FC19DC68B8CD5B5',8), int(z'240CA1CC77AC9C65',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />59</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'2DE92C6F592B0275',8), int(z'4A7484AA6EA6E483',8), int(z'5CB0A9DCBD41FBD4',8), int(z'76F988DA831153B5',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />60</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'983E5152EE66DFAB',8), int(z'A831C66D2DB43210',8), int(z'B00327C898FB213F',8), int(z'BF597FC7BEEF0EE4',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />61</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'C6E00BF33DA88FC2',8), int(z'D5A79147930AA725',8), int(z'06CA6351E003826F',8), int(z'142929670A0E6E70',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />62</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'27B70A8546D22FFC',8), int(z'2E1B21385C26C926',8), int(z'4D2C6DFC5AC42AED',8), int(z'53380D139D95B3DF',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />63</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'650A73548BAF63DE',8), int(z'766A0ABB3C77B2A8',8), int(z'81C2C92E47EDAEE6',8), int(z'92722C851482353B',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />64</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'A2BFE8A14CF10364',8), int(z'A81A664BBC423001',8), int(z'C24B8B70D0F89791',8), int(z'C76C51A30654BE30',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />65</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'D192E819D6EF5218',8), int(z'D69906245565A910',8), int(z'F40E35855771202A',8), int(z'106AA07032BBD1B8',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />66</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'19A4C116B8D2D0C8',8), int(z'1E376C085141AB53',8), int(z'2748774CDF8EEB99',8), int(z'34B0BCB5E19B48A8',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />67</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'391C0CB3C5C95A63',8), int(z'4ED8AA4AE3418ACB',8), int(z'5B9CCA4F7763E373',8), int(z'682E6FF3D6B2B8A3',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />68</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'748F82EE5DEFB2FC',8), int(z'78A5636F43172F60',8), int(z'84C87814A1F0AB72',8), int(z'8CC702081A6439EC',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />69</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'90BEFFFA23631E28',8), int(z'A4506CEBDE82BDE9',8), int(z'BEF9A3F7B2C67915',8), int(z'C67178F2E372532B',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />70</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'CA273ECEEA26619C',8), int(z'D186B8C721C0C207',8), int(z'EADA7DD6CDE0EB1E',8), int(z'F57D4F7FEE6ED178',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />71</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'06F067AA72176FBA',8), int(z'0A637DC5A2C898A6',8), int(z'113F9804BEF90DAE',8), int(z'1B710B35131C471B',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />72</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'28DB77F523047D84',8), int(z'32CAAB7B40C72493',8), int(z'3C9EBE0A15C9BEBC',8), int(z'431D67C49C100D4C',8), &amp;</td></tr><tr><td class="codeNumber"><a name="" />73</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">     int(z'4CC5D4BECB3E42B6',8), int(z'597F299CFC657E2A',8), int(z'5FCB6FAB3AD6FAEC',8), int(z'6C44198C4A475817',8) ]</td></tr><tr><td class="codeNumber"><a name="" />74</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />75</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Size of the message block (1024 bits = 128 bytes)</td></tr><tr><td class="codeNumber"><a name="" />76</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  integer, parameter :: size_of_M = 128</td></tr><tr><td class="codeNumber"><a name="" />77</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />78</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Size of the message schedule</td></tr><tr><td class="codeNumber"><a name="" />79</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  integer, parameter :: size_of_W = 80</td></tr><tr><td class="codeNumber"><a name="" />80</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />81</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Size of the hash (in 64-bit words)</td></tr><tr><td class="codeNumber"><a name="" />82</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  integer, parameter :: size_of_H = 6</td></tr><tr><td class="codeNumber"><a name="" />83</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />84</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Hashing algorithm for SHA-348</td></tr><tr><td class="codeNumber"><a name="" />85</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  type, extends(t_hash64) :: t_sha384</td></tr><tr><td class="codeNumber"><a name="" />86</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">    private</td></tr><tr><td class="codeNumber"><a name="" />87</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />88</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">    contains</td></tr><tr><td class="codeNumber"><a name="" />89</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />90</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!     Hashing initialisation</td></tr><tr><td class="codeNumber"><a name="" />91</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!     Initialises the hashing base message-digest operation</td></tr><tr><td class="codeNumber"><a name="" />92</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">      procedure, nopass :: initialise =&gt; sha384_initialise</td></tr><tr><td class="codeNumber"><a name="" />93</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />94</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!     Hashing update operation</td></tr><tr><td class="codeNumber"><a name="" />95</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!     Continues the message-digest operation, processing</td></tr><tr><td class="codeNumber"><a name="" />96</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!     another message block, and updating the context</td></tr><tr><td class="codeNumber"><a name="" />97</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">      procedure :: update =&gt; sha384_update</td></tr><tr><td class="codeNumber"><a name="" />98</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />99</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!     Hashing finalisation</td></tr><tr><td class="codeNumber"><a name="" />100</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!     Finalises the hashing process and returns the resulting hash</td></tr><tr><td class="codeNumber"><a name="" />101</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!     Overrides the generic finalisation in t_hash64 to truncate the digest</td></tr><tr><td class="codeNumber"><a name="" />102</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">      procedure :: finalise =&gt; sha384_finalise</td></tr><tr><td class="codeNumber"><a name="" />103</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />104</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!     Get hash size</td></tr><tr><td class="codeNumber"><a name="" />105</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">      procedure, nopass :: get_hash_size =&gt; sha384_get_hash_size</td></tr><tr><td class="codeNumber"><a name="" />106</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />107</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  end type t_sha384</td></tr><tr><td class="codeNumber"><a name="" />108</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />109</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Constructor interface</td></tr><tr><td class="codeNumber"><a name="" />110</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  interface sha384</td></tr><tr><td class="codeNumber"><a name="" />111</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">    module procedure sha384_default</td></tr><tr><td class="codeNumber"><a name="" />112</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">  end interface sha384</td></tr><tr><td class="codeNumber"><a name="" />113</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />114</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">!- End of module variable declarations ----------------------------------------</td></tr><tr><td class="codeNumber"><a name="" />115</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />116</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">contains</td></tr><tr><td class="codeNumber"><a name="" />117</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />118</td><td class="codeKeyGood">0</td><td class="codeKeyGood">0</td><td class="codeLineGood">! Default constructor</td></tr><tr><td class="codeNumberDark"><a name="sha384_default" />119</td><td class="codeKeyGoodDark">1</td><td class="codeKeyGoodDark">1</td><td class="codeLineGoodDark">pure function sha384_default() result(res)</td></tr><tr><td class="codeNumber"><a name="" />120</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />121</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Constructed structure</td></tr><tr><td class="codeNumber"><a name="" />122</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  type(t_sha384) :: res</td></tr><tr><td class="codeNumber"><a name="" />123</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />124</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Initialise</td></tr><tr><td class="codeNumber"><a name="" />125</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  res = t_sha384()</td></tr><tr><td class="codeNumber"><a name="" />126</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />127</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">end function sha384_default</td></tr><tr><td class="codeNumber"><a name="" />128</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />129</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />130</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Initialisation</td></tr><tr><td class="codeNumberDark"><a name="sha384_initialise" />131</td><td class="codeKeyGoodDark">1</td><td class="codeKeyGoodDark">1</td><td class="codeLineGoodDark">pure subroutine sha384_initialise( H )</td></tr><tr><td class="codeNumber"><a name="" />132</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />133</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Initial value for hash buffer</td></tr><tr><td class="codeNumber"><a name="" />134</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  class(*), allocatable, dimension(:), intent(inout) :: H</td></tr><tr><td class="codeNumber"><a name="" />135</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />136</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Return initial hash</td></tr><tr><td class="codeNumber"><a name="" />137</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  allocate( H, source=H0 )</td></tr><tr><td class="codeNumber"><a name="" />138</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />139</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">end subroutine sha384_initialise</td></tr><tr><td class="codeNumber"><a name="" />140</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />141</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />142</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Message disgst update</td></tr><tr><td class="codeNumberDark"><a name="sha384_update" />143</td><td class="codeKeyGoodDark">1</td><td class="codeKeyGoodDark">1</td><td class="codeLineGoodDark">pure subroutine sha384_update( this, M, H )</td></tr><tr><td class="codeNumber"><a name="" />144</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />145</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Calling object</td></tr><tr><td class="codeNumber"><a name="" />146</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  class(t_sha384), intent(in) :: this</td></tr><tr><td class="codeNumber"><a name="" />147</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />148</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! The message schedule</td></tr><tr><td class="codeNumber"><a name="" />149</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  integer(kind=1), dimension(:), intent(in) :: M</td></tr><tr><td class="codeNumber"><a name="" />150</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />151</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Hash buffer</td></tr><tr><td class="codeNumber"><a name="" />152</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  class(*), dimension(:), intent(inout) :: H</td></tr><tr><td class="codeNumber"><a name="" />153</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />154</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Local variables</td></tr><tr><td class="codeNumber"><a name="" />155</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  integer :: i, j</td></tr><tr><td class="codeNumber"><a name="" />156</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  integer(kind=8), dimension(size_of_W) :: w</td></tr><tr><td class="codeNumber"><a name="" />157</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  integer(kind=8) :: t1, t2, s0, s1</td></tr><tr><td class="codeNumber"><a name="" />158</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  integer(kind=8) :: a, b, c, d, e, f, g, n</td></tr><tr><td class="codeNumber"><a name="" />159</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />160</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Initalise local variables</td></tr><tr><td class="codeNumber"><a name="" />161</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  w = 0_8</td></tr><tr><td class="codeNumber"><a name="" />162</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />163</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Prepare the message schedule (1-16)</td></tr><tr><td class="codeNumber"><a name="" />164</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! The transfer operations set for every double-word W four bytes from the message block</td></tr><tr><td class="codeNumber"><a name="" />165</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! The message block is assigned left to right whereas W is assined right to left</td></tr><tr><td class="codeNumber"><a name="" />166</td><td class="codeKeyGood">2</td><td class="codeKeyGood">2</td><td class="codeLineGood">  do i = 1, 16</td></tr><tr><td class="codeNumber"><a name="" />167</td><td class="codeKeyGood">2</td><td class="codeKeyGood">2</td><td class="codeLineGood">    j = 8 * ( i - 1 ) + 1</td></tr><tr><td class="codeNumber"><a name="" />168</td><td class="codeKeyGood">2</td><td class="codeKeyGood">2</td><td class="codeLineGood">    w(i) = transfer( M(j+7:j:-1), w(i) )</td></tr><tr><td class="codeNumber"><a name="" />169</td><td class="codeKeyGood">2</td><td class="codeKeyGood">1</td><td class="codeLineGood">  end do</td></tr><tr><td class="codeNumber"><a name="" />170</td><td class="codeKeyGood">2</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />171</td><td class="codeKeyGood">2</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Prepare the message schedule (17-64)</td></tr><tr><td class="codeNumber"><a name="" />172</td><td class="codeKeyGood">3</td><td class="codeKeyGood">2</td><td class="codeLineGood">  do i = 17, size(w)</td></tr><tr><td class="codeNumber"><a name="" />173</td><td class="codeKeyGood">3</td><td class="codeKeyGood">2</td><td class="codeLineGood">    w(i) = this%low_s1(w(i-2)) + w(i-7) + this%low_s0(w(i-15)) + w(i-16)</td></tr><tr><td class="codeNumber"><a name="" />174</td><td class="codeKeyGood">3</td><td class="codeKeyGood">1</td><td class="codeLineGood">  end do</td></tr><tr><td class="codeNumber"><a name="" />175</td><td class="codeKeyGood">3</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />176</td><td class="codeKeyGood">3</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Initialise the intermediate variables</td></tr><tr><td class="codeNumber"><a name="" />177</td><td class="codeKeyGood">3</td><td class="codeKeyGood">2</td><td class="codeLineGood">  select type( H )</td></tr><tr><td class="codeNumber"><a name="" />178</td><td class="codeKeyGood">4</td><td class="codeKeyGood">2</td><td class="codeLineGood">    type is(integer(kind=8))</td></tr><tr><td class="codeNumber"><a name="" />179</td><td class="codeKeyGood">4</td><td class="codeKeyGood">2</td><td class="codeLineGood">      a = H(1)</td></tr><tr><td class="codeNumber"><a name="" />180</td><td class="codeKeyGood">4</td><td class="codeKeyGood">2</td><td class="codeLineGood">      b = H(2)</td></tr><tr><td class="codeNumber"><a name="" />181</td><td class="codeKeyGood">4</td><td class="codeKeyGood">2</td><td class="codeLineGood">      c = H(3)</td></tr><tr><td class="codeNumber"><a name="" />182</td><td class="codeKeyGood">4</td><td class="codeKeyGood">2</td><td class="codeLineGood">      d = H(4)</td></tr><tr><td class="codeNumber"><a name="" />183</td><td class="codeKeyGood">4</td><td class="codeKeyGood">2</td><td class="codeLineGood">      e = H(5)</td></tr><tr><td class="codeNumber"><a name="" />184</td><td class="codeKeyGood">4</td><td class="codeKeyGood">2</td><td class="codeLineGood">      f = H(6)</td></tr><tr><td class="codeNumber"><a name="" />185</td><td class="codeKeyGood">4</td><td class="codeKeyGood">2</td><td class="codeLineGood">      g = H(7)</td></tr><tr><td class="codeNumber"><a name="" />186</td><td class="codeKeyGood">4</td><td class="codeKeyGood">2</td><td class="codeLineGood">      n = H(8)</td></tr><tr><td class="codeNumber"><a name="" />187</td><td class="codeKeyGood">4</td><td class="codeKeyGood">1</td><td class="codeLineGood">  end select</td></tr><tr><td class="codeNumber"><a name="" />188</td><td class="codeKeyGood">4</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />189</td><td class="codeKeyGood">4</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Cycle on the intermediate variables</td></tr><tr><td class="codeNumber"><a name="" />190</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">  do i = 1, size(w)</td></tr><tr><td class="codeNumber"><a name="" />191</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    s0 = this%high_s0(a)</td></tr><tr><td class="codeNumber"><a name="" />192</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    s1 = this%high_s1(e)</td></tr><tr><td class="codeNumber"><a name="" />193</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    t1 = n + s1 + this%choose(e,f,g) + K(i) + w(i)</td></tr><tr><td class="codeNumber"><a name="" />194</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    t2 = s0 + this%majority(a,b,c)</td></tr><tr><td class="codeNumber"><a name="" />195</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    n = g</td></tr><tr><td class="codeNumber"><a name="" />196</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    g = f</td></tr><tr><td class="codeNumber"><a name="" />197</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    f = e</td></tr><tr><td class="codeNumber"><a name="" />198</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    e = d + t1</td></tr><tr><td class="codeNumber"><a name="" />199</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    d = c</td></tr><tr><td class="codeNumber"><a name="" />200</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    c = b</td></tr><tr><td class="codeNumber"><a name="" />201</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    b = a</td></tr><tr><td class="codeNumber"><a name="" />202</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">    a = t1 + t2</td></tr><tr><td class="codeNumber"><a name="" />203</td><td class="codeKeyGood">5</td><td class="codeKeyGood">1</td><td class="codeLineGood">  end do</td></tr><tr><td class="codeNumber"><a name="" />204</td><td class="codeKeyGood">5</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />205</td><td class="codeKeyGood">5</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Update the intermediate hash</td></tr><tr><td class="codeNumber"><a name="" />206</td><td class="codeKeyGood">5</td><td class="codeKeyGood">2</td><td class="codeLineGood">  select type( H )</td></tr><tr><td class="codeNumber"><a name="" />207</td><td class="codeKeyGood">6</td><td class="codeKeyGood">2</td><td class="codeLineGood">    type is(integer(kind=8))</td></tr><tr><td class="codeNumber"><a name="" />208</td><td class="codeKeyGood">6</td><td class="codeKeyGood">2</td><td class="codeLineGood">      H(1) = a + H(1)</td></tr><tr><td class="codeNumber"><a name="" />209</td><td class="codeKeyGood">6</td><td class="codeKeyGood">2</td><td class="codeLineGood">      H(2) = b + H(2)</td></tr><tr><td class="codeNumber"><a name="" />210</td><td class="codeKeyGood">6</td><td class="codeKeyGood">2</td><td class="codeLineGood">      H(3) = c + H(3)</td></tr><tr><td class="codeNumber"><a name="" />211</td><td class="codeKeyGood">6</td><td class="codeKeyGood">2</td><td class="codeLineGood">      H(4) = d + H(4)</td></tr><tr><td class="codeNumber"><a name="" />212</td><td class="codeKeyGood">6</td><td class="codeKeyGood">2</td><td class="codeLineGood">      H(5) = e + H(5)</td></tr><tr><td class="codeNumber"><a name="" />213</td><td class="codeKeyGood">6</td><td class="codeKeyGood">2</td><td class="codeLineGood">      H(6) = f + H(6)</td></tr><tr><td class="codeNumber"><a name="" />214</td><td class="codeKeyGood">6</td><td class="codeKeyGood">2</td><td class="codeLineGood">      H(7) = g + H(7)</td></tr><tr><td class="codeNumber"><a name="" />215</td><td class="codeKeyGood">6</td><td class="codeKeyGood">2</td><td class="codeLineGood">      H(8) = n + H(8)</td></tr><tr><td class="codeNumber"><a name="" />216</td><td class="codeKeyGood">6</td><td class="codeKeyGood">1</td><td class="codeLineGood">  end select</td></tr><tr><td class="codeNumber"><a name="" />217</td><td class="codeKeyGood">6</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />218</td><td class="codeKeyGood">6</td><td class="codeKeyGood">1</td><td class="codeLineGood">end subroutine sha384_update</td></tr><tr><td class="codeNumber"><a name="" />219</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />220</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />221</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Finalise the message disgest</td></tr><tr><td class="codeNumber"><a name="" />222</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Overrides the generic finalisation in t_hash64 to truncate the digest</td></tr><tr><td class="codeNumberDark"><a name="sha384_finalise" />223</td><td class="codeKeyGoodDark">1</td><td class="codeKeyGoodDark">1</td><td class="codeLineGoodDark">pure function sha384_finalise( this, H ) result(res)</td></tr><tr><td class="codeNumber"><a name="" />224</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />225</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! The hash structure</td></tr><tr><td class="codeNumber"><a name="" />226</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  class(t_sha384), intent(in) :: this</td></tr><tr><td class="codeNumber"><a name="" />227</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />228</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Hash buffer</td></tr><tr><td class="codeNumber"><a name="" />229</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  class(*), dimension(:), intent(in) :: H</td></tr><tr><td class="codeNumber"><a name="" />230</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />231</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Resulting hash</td></tr><tr><td class="codeNumber"><a name="" />232</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  integer(kind=1), dimension(:), allocatable :: res</td></tr><tr><td class="codeNumber"><a name="" />233</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />234</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Local varaibles</td></tr><tr><td class="codeNumber"><a name="" />235</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  integer(kind=8), dimension(size(H)) :: local8</td></tr><tr><td class="codeNumber"><a name="" />236</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />237</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Allocate resulting hash (initial allocation)</td></tr><tr><td class="codeNumber"><a name="" />238</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  allocate( res(this%get_hash_size()) )</td></tr><tr><td class="codeNumber"><a name="" />239</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />240</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Reoroder the bytes</td></tr><tr><td class="codeNumber"><a name="" />241</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! The solution is in 8 64-bit integers left to write with</td></tr><tr><td class="codeNumber"><a name="" />242</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! their bytes order right to left.</td></tr><tr><td class="codeNumber"><a name="" />243</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! First step: arrange al qwords right to left by qword</td></tr><tr><td class="codeNumber"><a name="" />244</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Second step: revert all bytes left to right</td></tr><tr><td class="codeNumber"><a name="" />245</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Third step: truncate to the expected size of the hash</td></tr><tr><td class="codeNumber"><a name="" />246</td><td class="codeKeyGood">1</td><td class="codeKeyGood">2</td><td class="codeLineGood">  select type( H )</td></tr><tr><td class="codeNumber"><a name="" />247</td><td class="codeKeyGood">2</td><td class="codeKeyGood">2</td><td class="codeLineGood">    type is(integer(kind=8))</td></tr><tr><td class="codeNumber"><a name="" />248</td><td class="codeKeyGood">2</td><td class="codeKeyGood">2</td><td class="codeLineGood">    local8 = H(size(H):1:-1)</td></tr><tr><td class="codeNumber"><a name="" />249</td><td class="codeKeyGood">2</td><td class="codeKeyGood">1</td><td class="codeLineGood">  end select</td></tr><tr><td class="codeNumber"><a name="" />250</td><td class="codeKeyGood">2</td><td class="codeKeyGood">1</td><td class="codeLineGood">  res = transfer( local8, res )</td></tr><tr><td class="codeNumber"><a name="" />251</td><td class="codeKeyGood">2</td><td class="codeKeyGood">1</td><td class="codeLineGood">  res = res(size(res):1:-1)</td></tr><tr><td class="codeNumber"><a name="" />252</td><td class="codeKeyGood">2</td><td class="codeKeyGood">1</td><td class="codeLineGood">  res = res(:this%get_hash_size())</td></tr><tr><td class="codeNumber"><a name="" />253</td><td class="codeKeyGood">2</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />254</td><td class="codeKeyGood">2</td><td class="codeKeyGood">1</td><td class="codeLineGood">end function sha384_finalise</td></tr><tr><td class="codeNumber"><a name="" />255</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />256</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />257</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Get the hash size (bytes) for this algorithm</td></tr><tr><td class="codeNumberDark"><a name="sha384_get_hash_size" />258</td><td class="codeKeyGoodDark">1</td><td class="codeKeyGoodDark">1</td><td class="codeLineGoodDark">pure function sha384_get_hash_size() result(res)</td></tr><tr><td class="codeNumber"><a name="" />259</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />260</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Hash size</td></tr><tr><td class="codeNumber"><a name="" />261</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  integer :: res</td></tr><tr><td class="codeNumber"><a name="" />262</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />263</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">! Return the size of the hash (in bytes)</td></tr><tr><td class="codeNumber"><a name="" />264</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">  res = 8 * size_of_H</td></tr><tr><td class="codeNumber"><a name="" />265</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />266</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">end function sha384_get_hash_size</td></tr><tr><td class="codeNumber"><a name="" />267</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr><tr><td class="codeNumber"><a name="" />268</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood">end module m_sha384</td></tr><tr><td class="codeNumber"><a name="" />269</td><td class="codeKeyGood">1</td><td class="codeKeyGood">1</td><td class="codeLineGood" /></tr></table></center><center><table border="0" cellpadding="2" cellspacing="0" width="100%"><tr><td height="3" /></tr><tr><td class="ruler" height="3" colspan="2" /></tr><tr><td height="12" valign="bottom" class="headerValue2">Copyright © 2020, Fran Martinez Fadrique &lt;Fran.Martinez.Fadrique@gmail.com&gt;</td></tr></table></center></body></html>